[2025-09-17 15:05:09][__main__][INFO] - Starting ClinicalBERT fine-tuning for readmission prediction
[2025-09-17 15:05:09][__main__][INFO] - Configuration:
data:
  data_path: /ssd-shared/yichen_data/mimic_iv_readmission_tuning.json
  test_size: 0.2
  random_state: 42
model:
  model_name: medicalai/ClinicalBERT
  model_cache_dir: /ssd-shared/yichen_models
  max_length: 256
  num_labels: 2
training:
  output_dir: /ssd-shared/yichen_models/clinical_bert_readmission
  train_batch_size: 16
  eval_batch_size: 32
  learning_rate: 2.0e-05
  num_train_epochs: 3
  warmup_steps: 500
  weight_decay: 0.01
  fp16: true
  dataloader_num_workers: 4
  save_strategy: epoch
  eval_strategy: epoch
  load_best_model_at_end: true
  metric_for_best_model: eval_f1
  early_stopping_patience: 2
  logging_steps: 100
  save_total_limit: 3
  greater_is_better: true
  report_to: null
experiment_name: clinical_bert_readmission
tensor_parallelism: 4
cuda_visible_devices: 0,1,4,7

[2025-09-17 15:05:09][__main__][INFO] - Loading data from /ssd-shared/yichen_data/mimic_iv_readmission_tuning.json
[2025-09-17 15:05:10][__main__][INFO] - Loaded 25160 samples
[2025-09-17 15:05:10][__main__][INFO] - Label distribution: [19361  5799]
[2025-09-17 15:05:10][__main__][INFO] - Splitting data into train/validation sets
[2025-09-17 15:05:10][__main__][INFO] - Train set: 20128 samples
[2025-09-17 15:05:10][__main__][INFO] - Validation set: 5032 samples
[2025-09-17 15:05:10][__main__][INFO] - Loading model and tokenizer: medicalai/ClinicalBERT
[2025-09-17 15:05:10][__main__][INFO] - Using cache directory: /ssd-shared/yichen_models
[2025-09-17 15:05:12][__main__][INFO] - Successfully loaded medicalai/ClinicalBERT
[2025-09-17 15:05:12][__main__][INFO] - Model max position embeddings: 512
[2025-09-17 15:05:12][__main__][INFO] - Creating datasets
[2025-09-17 15:05:13][__main__][INFO] - Using GPU for training
[2025-09-17 15:05:13][__main__][INFO] - Class weights: tensor([0.6498, 2.1694], device='cuda:0')
[2025-09-17 15:05:13][__main__][INFO] - Starting training...
